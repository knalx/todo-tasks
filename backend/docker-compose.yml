# Use root/example as user/password credentials
version: '3.1'

services:  
    mongodb:
      image: mongo:7
      container_name: mongodb
      ports:
        - '27017:27017'
      command: mongod --replSet rs0
      healthcheck:
        test: |
          mongosh --eval "try { rs.status().ok } catch (e) { rs.initiate({ _id: 'rs0', members: [{ _id: 0, host: 'localhost:27017' }] }).ok }"
        interval: 500ms
        timeout: 5s
        retries: 5

    mongo-express:
      image: mongo-express
      restart: always
      ports:
        - 8081:8081
      environment:
        ME_CONFIG_MONGODB_ADMINUSERNAME: root
        ME_CONFIG_MONGODB_ADMINPASSWORD: pass
        ME_CONFIG_MONGODB_URL: mongodb://root:pass@mongo:27017/
        ME_CONFIG_BASICAUTH: false
